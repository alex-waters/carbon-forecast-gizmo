"use strict";!function(e,t,n){for(var r=function(e){return e<10?"0"+e:e},o=function(e){return e>400?{colour:"#EE3350",number:8,letter:"VH"}:e>300?{colour:"#F89834",number:6,letter:"H"}:e>200?{colour:"#FFE600   ",number:4,letter:"M"}:e>100?{colour:"#74C050",number:2,letter:"L"}:e>0?{colour:"#74C050",number:0,letter:"VL"}:void 0},a=function(t,n){var r=e.createElement("section");r.className="wrapper",r.style.width=7*n*16+"px",e.querySelector(".logos").style.maxWidth=7*n*16+"px";for(var o="",a=0;a<n;a++)o+='<div class="hour">\n                    <p class="timestamp"><time></time></p>\n                    <svg class="inactive icon--house" width="149" height="146" viewBox="0 0 149 146" xmlns="http://www.w3.org/2000/svg">\n                        <path d="M26 53.196L3 77h23v66h98V77h22L74.5 3 44 34.566V16H26v37.196z" stroke="#676767" stroke-width="7" fill="rgba(255,255,255,1)" fill-rule="evenodd" stroke-linejoin="round">\n                            <title>House</title>\n                        </path>\n                        <text x="59" y="105" font-family="\'Open Sans\', sans-serif" font-size="40" fill="#000"></text>\n                    </svg>\n                </div>';r.innerHTML+=o,t.appendChild(r)},l=function(t,n){for(var r=t.querySelectorAll("svg"),a=t.querySelectorAll("time"),l="uninitiated",i="uninitiated",s=function(t,n){var r=e.createElementNS("http://www.w3.org/2000/svg","svg");return r.setAttributeNS(null,"viewBox","0 0 49 59"),r.setAttributeNS(null,"width",49),r.setAttributeNS(null,"height",59),r.setAttributeNS(null,"class","icon--plug"),r.innerHTML='<g fill="none" fill-rule="evenodd">\n                                        <path d="M24.5 59V41.5M14 22V0M36 22V0" stroke="'+t+'" stroke-width="9" fill="'+t+'"/>\n                                        <path d="M.005 16c-.003.166-.005.333-.005.5C0 30.583 10.97 42 24.5 42S49 30.583 49 16.5c0-.167-.002-.334-.005-.5H.005z" fill="'+t+'" />\n                                        </g>\n                                    </svg>',[r,e.createTextNode(n)]},d=0;d<n.length;d++)a[d].appendChild(e.createTextNode(moment(n[d].from).tz("Europe/London").format("ha")+" - "+moment(n[d].to).tz("Europe/London").format("ha")));for(var u=0;u<n.length;u++)if(u>0&&moment(n[u].from).tz("Europe/London").format("YYYYMMDD")!==moment(n[u-1].from).tz("Europe/London").format("YYYYMMDD"))try{r[u].parentElement.style.borderLeft="2px dotted #999";var m=e.createElement("b"),p=e.createTextNode(moment(n[u].from).tz("Europe/London").format("dddd"));m.appendChild(p),a[u].appendChild(m)}catch(e){console.warn(e)}for(var c=0;c<n.length;c++){try{var h=o(n[c].intensity.average);"uninitiated"===l?l=c:n[c].intensity.average>n[l].intensity.average&&(l=c),"uninitiated"===i?i=c:n[c].intensity.average<n[i].intensity.average&&(i=c),r[c].querySelector("path").style.stroke=h.colour,r[c].querySelector("title").innerHTML=n[c].intensity.average+"g COâ‚‚ per kWh",r[c].querySelector("text").appendChild(e.createTextNode(h.letter)),r[c].querySelector("text").style.fill="#676767",r[c].style.top=9-h.number+"em"}catch(t){if(t)throw console.warn(t),a[c].appendChild(e.createTextNode(" (Forecast not yet available)")),r[c].querySelector("text").appendChild(e.createTextNode("?")),r[c].querySelector("text").style.fill="#ccc",t}a[c].style.color="#333"}a[l].parentElement.appendChild(s("#EE3350","Unplug")[0]),a[l].parentElement.appendChild(s("#EE3350","Unplug")[1]),a[i].parentElement.appendChild(s("#74C050","Plug in")[0]),a[i].parentElement.appendChild(s("#74C050","Plug in")[1]),a[i].parentElement.parentElement.style.backgroundColor="#d6e8ce",a[l].parentElement.parentElement.style.backgroundColor="#ffd3da"},i=e.getElementsByClassName("carbon-forecast"),s=0;s<i.length;s++)!function(e){var t=void 0,n=void 0,o=void 0;if((o=i[e].getAttribute("data-duration")?i[e].getAttribute("data-duration"):24)<4?o=4:o>48&&(o=48),i[e].getAttribute("data-from"))t=moment(i[e].getAttribute("data-from")).startOf("hour").tz("UTC").format("YYYY-MM-DDTHH:mm");else{var s=moment().startOf("hour").tz("UTC"),d=moment().startOf("hour").tz("Europe/London").format("HH"),u=s.format("HH"),m=void 0;m=parseInt(d)%2==0?parseInt(u):parseInt(u)-1,t=s.format("YYYY-MM-DDT")+r(m)+":00"}n=moment(t).add(o,"hours").tz("UTC").format("YYYY-MM-DDTHH:mm"),a(i[e],o/2);var p=new XMLHttpRequest;p.open("GET","https://k1nehbcl85.execute-api.eu-west-2.amazonaws.com/v1/intensity/stats/"+t+"/"+n+"/2",!0),p.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var t=JSON.parse(this.responseText);l(i[e],t.data)}},p.send(),p=null}(s)}(document,window);
//# sourceMappingURL=carbon-intensity-widget.js.map
