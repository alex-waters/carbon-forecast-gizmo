"use strict";!function(e,t,n){for(var r=function(e){return e<10?"0"+e:e},o=function(e){return e>400?{colour:"#EE3350",number:8,letter:"VH"}:e>300?{colour:"#F89834",number:6,letter:"H"}:e>200?{colour:"#FFE600   ",number:4,letter:"M"}:e>100?{colour:"#74C050",number:2,letter:"L"}:e>0?{colour:"#74C050",number:0,letter:"VL"}:void 0},a=function(e){var t=moment().endOf("day");return moment(e).isSameOrBefore(t)?"today":"tomorrow"},l=function(t,n){var r=e.createElement("section");r.className="wrapper",r.style.width=7*n*16+"px",e.querySelector(".logos").style.maxWidth=7*n*16+"px";for(var o="",a=0;a<n;a++)o+='<div class="hour">\n                        <p class="timestamp"><time></time></p>\n                        <svg class="inactive icon--house" width="149" height="146" viewBox="0 0 149 146" xmlns="http://www.w3.org/2000/svg">\n                            <path d="M26 53.196L3 77h23v66h98V77h22L74.5 3 44 34.566V16H26v37.196z" stroke="#676767" stroke-width="7" fill="rgba(255,255,255,1)" fill-rule="evenodd" stroke-linejoin="round">\n                                <title>House</title>\n                            </path>\n                            <text x="59" y="105" font-family="\'Open Sans\', sans-serif" font-size="40" fill="#000"></text>\n                        </svg>\n                    </div>';r.innerHTML+=o,t.appendChild(r)},i=function(t,n){for(var r=t.querySelectorAll("svg"),l=t.querySelectorAll("time"),i="uninitiated",s="uninitiated",d=function(t,n){var r=e.createElementNS("http://www.w3.org/2000/svg","svg");return r.setAttributeNS(null,"viewBox","0 0 49 59"),r.setAttributeNS(null,"width",49),r.setAttributeNS(null,"height",59),r.setAttributeNS(null,"class","icon--plug"),r.innerHTML='<g fill="none" fill-rule="evenodd">\n                                        <path d="M24.5 59V41.5M14 22V0M36 22V0" stroke="'+t+'" stroke-width="9" fill="'+t+'"/>\n                                        <path d="M.005 16c-.003.166-.005.333-.005.5C0 30.583 10.97 42 24.5 42S49 30.583 49 16.5c0-.167-.002-.334-.005-.5H.005z" fill="'+t+'" />\n                                        </g>\n                                    </svg>',[r,e.createTextNode(n)]},u=!1,m=0;m<n.length;m++){var c="";if(!1===u&&"tomorrow"===a(n[m].from)){u=!0;try{r[m].parentElement.style.borderLeft="2px dotted #999"}catch(e){console.warn(e)}c=e.createElement("b");var p=e.createTextNode(moment(n[m].from).tz("Europe/London").format("dddd"));c.appendChild(p)}l[m].appendChild(e.createTextNode(moment(n[m].from).tz("Europe/London").format("ha")+" - "+moment(n[m].to).tz("Europe/London").format("ha"))),""!==c&&l[m].appendChild(c)}for(var h=0;h<n.length;h++){try{var f=o(n[h].intensity.average);"uninitiated"===i?i=h:n[h].intensity.average>n[i].intensity.average&&(i=h),"uninitiated"===s?s=h:n[h].intensity.average<n[s].intensity.average&&(s=h),r[h].querySelector("path").style.stroke=f.colour,r[h].querySelector("title").innerHTML=n[h].intensity.average+"g COâ‚‚ per kWh",r[h].querySelector("text").appendChild(e.createTextNode(f.letter)),r[h].querySelector("text").style.fill="#676767",r[h].style.top=9-f.number+"em"}catch(t){if(t)throw console.warn(t),l[h].appendChild(e.createTextNode(" (Forecast not yet available)")),r[h].querySelector("text").appendChild(e.createTextNode("?")),r[h].querySelector("text").style.fill="#ccc",t}l[h].style.color="#333"}l[i].parentElement.appendChild(d("#EE3350","Unplug")[0]),l[i].parentElement.appendChild(d("#EE3350","Unplug")[1]),l[s].parentElement.appendChild(d("#74C050","Plug in")[0]),l[s].parentElement.appendChild(d("#74C050","Plug in")[1]),l[s].parentElement.parentElement.style.backgroundColor="#d6e8ce",l[i].parentElement.parentElement.style.backgroundColor="#ffd3da"},s=e.getElementsByClassName("carbon-forecast"),d=0;d<s.length;d++)!function(e){var t=void 0,n=void 0;if(s[e].getAttribute("data-from"))t=moment(s[e].getAttribute("data-from")).startOf("hour").tz("UTC").format("YYYY-MM-DDTHH:mm");else{var o=moment().startOf("hour").tz("UTC"),a=moment().startOf("hour").tz("Europe/London").format("HH"),d=o.format("HH"),u=void 0;u=parseInt(a)%2==0?parseInt(d):parseInt(d)-1,t=o.format("YYYY-MM-DDT")+r(u)+":00"}n=moment(t).add(24,"hours").tz("UTC").format("YYYY-MM-DDTHH:mm"),l(s[e],12);var m=new XMLHttpRequest;m.open("GET","https://k1nehbcl85.execute-api.eu-west-2.amazonaws.com/v1/intensity/stats/"+t+"/"+n+"/2",!0),m.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var t=JSON.parse(this.responseText);i(s[e],t.data)}},m.send(),m=null}(d)}(document,window);
//# sourceMappingURL=carbon-intensity-widget.js.map
