"use strict";!function(e,t,n){for(var r=function(e){return e<10?"0"+e:e},o=function(e){return e>400?{colour:"#EE3350",number:8,letter:"VH"}:e>300?{colour:"#F89834",number:6,letter:"H"}:e>200?{colour:"#FFE600   ",number:4,letter:"M"}:e>100?{colour:"#74C050",number:2,letter:"L"}:e>0?{colour:"#74C050",number:0,letter:"VL"}:void 0},a=function(e){var t=moment().endOf("day");return moment(e).isSameOrBefore(t)?"today":"tomorrow"},l=function(t,n){var r=e.createElement("section");r.className="wrapper",r.style.width=7*n*16+"px",e.querySelector(".logos").style.maxWidth=7*n*16+"px";for(var o="",a=0;a<n;a++)o+='<div class="hour">\n                        <p class="timestamp"><time></time></p>\n                        <svg class="inactive icon--house" width="149" height="146" viewBox="0 0 149 146" xmlns="http://www.w3.org/2000/svg">\n                            <title>House</title>\n                            <path d="M26 53.196L3 77h23v66h98V77h22L74.5 3 44 34.566V16H26v37.196z" stroke="#676767" stroke-width="7" fill="#fff" fill-rule="evenodd" stroke-linejoin="round" />\n                            <text x="59" y="105" font-family="\'Open Sans\', sans-serif" font-size="40" fill="#000"></text>\n                        </svg>\n                    </div>';r.innerHTML+=o,t.appendChild(r)},i=function(t,n){for(var r=t.querySelectorAll("svg"),l=t.querySelectorAll("time"),i="uninitiated",s="uninitiated",d=function(t,n){var r=49,o=59,a=e.createElementNS("http://www.w3.org/2000/svg","svg");return a.setAttributeNS(null,"viewBox","0 0 "+r+" "+o),a.setAttributeNS(null,"width",r),a.setAttributeNS(null,"height",o),a.setAttributeNS(null,"class","icon--plug"),a.innerHTML='<g fill="none" fill-rule="evenodd">\n                                        <path d="M24.5 59V41.5M14 22V0M36 22V0" stroke="'+t+'" stroke-width="9" fill="'+t+'"/>\n                                        <path d="M.005 16c-.003.166-.005.333-.005.5C0 30.583 10.97 42 24.5 42S49 30.583 49 16.5c0-.167-.002-.334-.005-.5H.005z" fill="'+t+'" />\n                                        </g>\n                                    </svg>',[a,e.createTextNode(n)]},u=!1,m=0;m<n.length;m++){var c="";if(!1===u&&"tomorrow"===a(n[m].from)){u=!0;try{r[m].parentElement.style.borderLeft="2px dotted #999"}catch(e){console.warn(e)}c=e.createElement("b");var p=e.createTextNode(moment(n[m].from).tz("Europe/London").format("dddd"));c.appendChild(p)}l[m].appendChild(e.createTextNode(moment(n[m].from).tz("Europe/London").format("ha")+" - "+moment(n[m].to).tz("Europe/London").format("ha"))),""!==c&&l[m].appendChild(c)}for(var f=0;f<n.length;f++){try{var h=o(n[f].intensity.average);"uninitiated"===i?i=f:n[f].intensity.average>n[i].intensity.average&&(i=f),"uninitiated"===s?s=f:n[f].intensity.average<n[s].intensity.average&&(s=f),r[f].querySelector("path").style.stroke=h.colour,r[f].querySelector("title").innerHTML=n[f].intensity.average+"g COâ‚‚ per kWh",r[f].querySelector("text").appendChild(e.createTextNode(h.letter)),r[f].querySelector("text").style.fill="#676767",r[f].style.top=9-h.number+"em"}catch(t){if(t)throw console.warn(t),l[f].appendChild(e.createTextNode(" (Forecast not yet available)")),r[f].querySelector("text").appendChild(e.createTextNode("?")),r[f].querySelector("text").style.fill="#ccc",t}l[f].style.color="#333"}l[i].parentElement.appendChild(d("#EE3350","Unplug")[0]),l[i].parentElement.appendChild(d("#EE3350","Unplug")[1]),l[s].parentElement.appendChild(d("#74C050","Plug in")[0]),l[s].parentElement.appendChild(d("#74C050","Plug in")[1]),l[s].parentElement.parentElement.style.backgroundColor="#d6e8ce",l[i].parentElement.parentElement.style.backgroundColor="#ffd3da"},s=e.getElementsByClassName("carbon-forecast"),d=function(e){var t=void 0,n=void 0,o="YYYY-MM-DDTHH:mm",a=24,d=2;if(s[e].getAttribute("data-from"))t=moment(s[e].getAttribute("data-from")).startOf("hour").tz("UTC").format(o);else{var u=moment().startOf("hour").tz("UTC"),m=moment().startOf("hour").tz("Europe/London"),c=m.format("HH"),p=u.format("HH"),f=void 0;f=parseInt(c)%2==0?parseInt(p):parseInt(p)-1,t=u.format("YYYY-MM-DDT")+r(f)+":00"}n=moment(t).add(a,"hours").tz("UTC").format(o),l(s[e],a/d);var h=new XMLHttpRequest;h.open("GET","https://k1nehbcl85.execute-api.eu-west-2.amazonaws.com/v1/intensity/stats/"+t+"/"+n+"/"+d,!0),h.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var t=JSON.parse(this.responseText);i(s[e],t.data)}},h.send(),h=null},u=0;u<s.length;u++)d(u)}(document,window);